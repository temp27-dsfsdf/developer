function initDCSitemap(e){console.log("dxentric sitemap v1.5 - ?sf_personalization_wpm");const t=document.referrer,n="https://mcp.dxentric.co.kr:4433/shop/",r=window.location.href,o=new URLSearchParams(window.location.search),a=r.split("?")[0],c=t.split("?")[0];let i,s;const l=[{name:"DXentric_Handlebars_Sample1",substitutionDefinitions:{personalizationContentId:{defaultValue:"[personalizationContentId]"},productImgUrl:{defaultValue:"[attributes].[product_image_url1]"},productMainTitle:{defaultValue:"[attributes].[product_main_title1]"},productSubTitle:{defaultValue:"[attributes].[product_sub_title1]"}},transformerType:"Handlebars",transformerTypeDetails:{html:'\n          <div>\n          <img src="{{subVar "productImgUrl"}}" alt="" class="w-72" />\n          <br />\n            <a href="https://www.dxentric.co.kr/">{{subVar "productMainTitle"}}</a>\n            <br />\n            <span>{{subVar "productSubTitle"}}</span>\n            <br />\n            <span>12,345원</span>\n          </div>\n        '},lastModifiedDate:(new Date).getTime()}],d=e;console.log("DXentric Personalization initialize."),SalesforceInteractions.Personalization.Config.initialize({additionalTransformers:[...l],personalizationExperienceConfigs:[...d]});const u=()=>{let e=document.querySelector("input#mail_value")?.value;return e||""},m=()=>{let e=localStorage.getItem("mcp_demo_cart_id");if(!e){const t=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1);e=`${t()}${t()}-${t()}-${t()}-${t()}-${t()}${t()}${t()}`,localStorage.setItem("mcp_demo_cart_id",e)}return e},p=e=>({eventType:e,ecrmLocaleCode:"ko_KR",ecrmUserId:u(),sourceUrl:r});SalesforceInteractions.init({name:"DXentric Salesforce Interactions Web SDK",personalization:{dataspace:"default"},cookieDomain:"mcp.dxentric.co.kr",consents:new Promise((e=>{const{OptIn:t,OptOut:n}=SalesforceInteractions.ConsentStatus;e([{purpose:SalesforceInteractions.ConsentPurpose.Tracking,provider:"Example Consent Manager",status:t}])}))}).then((()=>{console.log("DXentric Salesforce Interactions Web SDK is ready"),SalesforceInteractions.setLoggingLevel("DEBUG");const{listener:e,sendEvent:t,CartInteractionName:l,CatalogObjectInteractionName:d,OrderInteractionName:g}=SalesforceInteractions,y={locale:"ko_KR",onActionEvent:e=>{const t=u();t?.includes("@")&&SalesforceInteractions.sendEvent({interaction:{name:"identity",eventType:"identity",category:"Profile",emailAddress:t,...p("identity")}});const n=u();return n&&(e.interaction={...e.interaction,ecrmUserId:n}),e},listeners:[SalesforceInteractions.listener("keydown","input#search_input",(e=>{"Enter"===e.key&&S(e)}))]},f={name:"MainPageEntered",isMatch:()=>new RegExp(`${n}index\\.dg$`).test(a),interaction:{name:"MainPageEntered",eventType:"MainPageEntered",type:"WebPage",...p("MainPageEntered")},onActionEvent:e=>{}},S=e=>{e.preventDefault();const t=document.querySelector("input#search_input")?.value;t?.length>=2&&SalesforceInteractions.sendEvent({interaction:{name:"SearchKeyword",eventType:"SearchKeyword",...p("SearchKeyword"),ecrmSearchIndex:t}})},h={name:"PbpEntered",isMatch:()=>new RegExp(`${n}cart\\.dg$`).test(a),listeners:[e("load",window,(()=>{const e=document.querySelectorAll("tr:has(img)");Array.from(e).forEach((e=>{t({interaction:{name:"PbpEntered",eventType:"PbpEntered",type:"WebPage",...p("PbpEntered"),catalogObjectType:"Product",catalogObjectId:e.querySelector(".item_id")?.value||"",quantity:(()=>{const t=e.querySelector(".input-number");return parseInt(t?.value,10)||0})(),price:(()=>{const t=e.querySelector("td:nth-child(2) h5");return parseFloat(t?.textContent?.replace(/[^0-9]/g,"")||"0")})(),currency:"KRW"}})}))}))]},_={name:"CheckoutComp",isMatch:()=>new RegExp(`${n}checkout\\.dg$`).test(a),listeners:[e("load",window,(()=>{const e=document.querySelectorAll(".order_box .list li:not(:first-child)");Array.from(e).forEach((e=>{const n=e.querySelector(".item_id")?.value,r=e.querySelector(".cate_name").value;n&&t({interaction:{name:"CheckoutComp",type:"Product",...p("CheckoutComp"),ecrmOrderIdV3:m(),ecrmCurrency:"KRW",ecrmProductId:n,ecrmProductCat:r,ecrmQuantityV3:(()=>{const t=e.querySelector(".middle")?.textContent||"";return parseInt(t.replace("x",""),10)||0})(),ecrmPriceV3:(()=>{const t=e.querySelector(".last")?.textContent||"";return parseFloat(t.replace(/[^0-9]/g,""))})()}})}))}))]},I={name:"PdpEntered",isMatch:()=>new RegExp(`${n}product\\.dg$`).test(a)&&/product_seq=\d+/.test(r),interaction:{name:"PdpEntered",type:"Product",...p("PdpEntered"),ecrmProductId:document.querySelector("input#item_id")?.value||"",ecrmCurrency:"KRW",ecrmPrice:(()=>{const e=document.querySelector(".s_product_text h2");return i=parseFloat(e?.textContent.replace(/[^0-9]/g,"")||"0"),i})(),ecrmProductCat:(()=>{const e=document.querySelector(".list li:first-child a");if(!e)return"";const t=e.textContent.trim(),n=t.indexOf(": ");return-1!==n?t.substring(n+2):""})(),imageURL:(s=document.querySelector(".lslide.active img")?.src||"",s)},listeners:[SalesforceInteractions.listener("mousedown","a.btn_3",(e=>{const t=e.target;if(!t?.textContent?.toLowerCase().includes("add to cart"))return;const n=parseInt(document.querySelector("input#qty")?.value,10)||0;n>0&&i&&SalesforceInteractions.sendEvent({interaction:{name:"AddToCartClicked",type:"Product",...p("AddToCartClicked"),ecrmCartId:m(),ecrmCurrency:"KRW",ecrmProductId:document.querySelector("input#item_id")?.value||"",ecrmPrice:i,ecrmQuantity:n,imageURL:s}})}),{capture:!0})]},P={name:"PlpEntered",isMatch:()=>new RegExp(`${n}category\\.dg`).test(a),onActionEvent:e=>{SalesforceInteractions.Personalization.fetch(["DXentric_MainPage_Featured_Category"]).then((e=>{console.log("Personalization Response!! ",e);const{personalizations:[t]}=e,{attributes:n,data:r,personalizationId:o,personalizationPointId:a,personalizationPointName:c}=t,{product_image_url1:i,product_main_title1:s,product_sub_title1:l,product_image_url2:d,product_main_title2:u}=n})).catch((e=>{console.log("fetch 에러!!",e)}))},interaction:{name:"PlpEntered",type:"Product",...p("PlpEntered"),ecrmProductCat:o.get("cate_seq")||"",ecrmProductSubCat:o.get("sub_cate_seq")||""}},C={name:"ecrmLogined",isMatch:()=>{const e=new RegExp(`${n}login\\.dg`).test(c),t=u()?.length>0;return e&&t},interaction:{name:"ecrmLogined",...p("ecrmLogined"),ecrmHostType:"web",ecrmGaClientId:""}},b={name:"ecrmLoginPage",isMatch:()=>new RegExp(`${n}login\\.dg`).test(r),interaction:{name:"ecrmLoginPage",...p("ecrmLoginPage"),ecrmHostType:"web"},listeners:[SalesforceInteractions.listener("mousedown","button.btn_3",(()=>{const e=document.getElementById("name"),t=document.getElementById("password");e?.value.trim().length>=3&&t?.value.trim().length>=3&&SalesforceInteractions.sendEvent({interaction:{name:"ecrmLogined",...p("ecrmLogined"),ecrmHostType:"web",ecrmGaClientId:""}})}))]},E={name:"default",interaction:{name:"Default",...p("Default")}};SalesforceInteractions.initSitemap({GLOBAL:y,pageTypeDefault:E,pageTypes:[h,_,C,f,P,I,b]})}))}document.addEventListener("DOMContentLoaded",(()=>{console.log(">>>>>>>>> full sitemap 실행하기");fetch("https://cdn.jsdelivr.net/gh/temp27-dsfsdf/marketer@main/template.json").then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{console.log("불러온 JSON 데이터:",e),initDCSitemap(e)})).catch((e=>{console.error("Fetching JSON failed:",e)}))}));
